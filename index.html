<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpLine Generator - Generatore di Spline su Griglia Cartesiana</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <header>
            <h1>SpLine Generator</h1>
            <div class="toolbar">
                <button id="settingsBtn" class="btn">‚öôÔ∏è Impostazioni</button>
                <div class="file-group">
                    <input type="text" id="projectName" placeholder="Nome progetto" maxlength="50" style="padding: 6px 10px; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.2); color: white; font-size: 14px;">
                    <button id="saveBtn" class="btn">üíæ Salva Progetto</button>
                    <button id="loadBtn" class="btn">üìÅ Carica Progetto</button>
                    <input type="file" id="fileInput" accept=".json" style="display: none;">
                </div>
                <div class="export-group">
                    <select id="robotType" class="robot-select">
                        <option value="kuka">KUKA KRL</option>
                        <option value="fanuc" disabled>FANUC (futuro)</option>
                        <option value="abb" disabled>ABB RAPID (futuro)</option>
                        <option value="motoman" disabled>MOTOMAN INFORM (futuro)</option>
                    </select>
                    <button id="exportBtn" class="btn btn-export">ü§ñ Esporta Robot</button>
                </div>
                <div class="clear-group">
                    <button id="clearSplineBtn" class="btn btn-warning">üóëÔ∏è Pulisci Spline</button>
                    <button id="clearShapesBtn" class="btn btn-warning">üóëÔ∏è Pulisci Geometrie</button>
                </div>
                <div class="tool-group">
                    <span>Strumenti:</span>
                    <button id="selectBtn" class="btn tool-btn" data-tool="select" title="Strumento Selezione">üîò</button>
                    <button id="splineBtn" class="btn tool-btn active" data-tool="spline" title="Strumento Spline">„Ä∞Ô∏è</button>
                    <button id="rectBtn" class="btn tool-btn" data-tool="rectangle" title="Strumento Rettangolo">‚ñ≠</button>
                    <button id="circleBtn" class="btn tool-btn" data-tool="circle" title="Strumento Cerchio">‚óã</button>
                </div>
                <div class="play-group">
                    <button id="playBtn" class="btn play-btn">‚ñ∂Ô∏è</button>
                    <button id="pauseBtn" class="btn play-btn" style="display: none;">‚è∏Ô∏è</button>
                    <button id="stopBtn" class="btn play-btn">‚èπÔ∏è</button>
                    <div class="time-indicator">
                        <span id="timeDisplay">00:00.00 / 00:00.00</span>
                    </div>
                </div>
                <div class="info">
                    <span id="coordinates">X: 0 mm, Y: 0 mm</span>
                </div>
            </div>
        </header>

        <main>
            <div class="workspace">
                <div id="canvasContainer">
                    <canvas id="gridCanvas" width="1200" height="800"></canvas>
                    <canvas id="shapeCanvas" width="1200" height="800"></canvas>
                    <canvas id="splineCanvas" width="1200" height="800"></canvas>
                    <canvas id="animationCanvas" width="1200" height="800"></canvas>
                </div>
                
                <div id="sidePanel" class="side-panel">
                    <div class="panel-header">
                        <div class="tab-container">
                            <button class="tab-btn active" data-tab="spline-tab">üìè Punti Spline</button>
                            <button class="tab-btn" data-tab="shapes-tab">üìê Geometrie</button>
                        </div>
                    </div>
                    
                    <div class="panel-content">
                        <!-- Tab Punti Spline -->
                        <div id="spline-tab" class="tab-content active">
                            <div class="tab-toolbar">
                                <div class="spline-controls">
                                    <label>Velocit√† selezionati:</label>
                                    <input type="number" id="bulkVelocity" placeholder="mm/s" min="0" step="0.1" value="30">
                                    <button id="applyBulkVelocity" class="btn btn-small">Applica</button>
                                </div>
                                <div class="spline-info">
                                    <span id="pointCount">0 punti</span>
                                    <span id="selectedCount">0 selezionati</span>
                                    <span id="splineLength">Lunghezza: 0.0 mm</span>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <table id="splineTable">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" id="selectAllPoints"></th>
                                            <th>ID</th>
                                            <th>X (mm)</th>
                                            <th>Y (mm)</th>
                                            <th>Velocit√† (mm/s)</th>
                                            <th>Azioni</th>
                                        </tr>
                                    </thead>
                                    <tbody id="splineTableBody">
                                        <!-- Punti spline verranno inseriti qui -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Tab Geometrie -->
                        <div id="shapes-tab" class="tab-content">
                            <div class="tab-toolbar">
                                <div class="shapes-info">
                                    <span id="shapesCount">0 geometrie</span>
                                </div>
                            </div>
                            
                            <div class="table-container">
                                <table id="shapesTable">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Tipo</th>
                                            <th>Posizione X (mm)</th>
                                            <th>Posizione Y (mm)</th>
                                            <th>Dimensioni</th>
                                            <th>Azioni</th>
                                        </tr>
                                    </thead>
                                    <tbody id="shapesTableBody">
                                        <!-- Geometrie verranno inserite qui -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Modal Impostazioni -->
        <div id="settingsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Impostazioni</h2>
                    <span class="close">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <h3>Griglia Cartesiana</h3>
                        <div class="setting-row">
                            <label for="minX">Minimo X (mm):</label>
                            <input type="number" id="minX" value="-100" step="10">
                        </div>
                        <div class="setting-row">
                            <label for="maxX">Massimo X (mm):</label>
                            <input type="number" id="maxX" value="100" step="10">
                        </div>
                        <div class="setting-row">
                            <label for="minY">Minimo Y (mm):</label>
                            <input type="number" id="minY" value="-100" step="10">
                        </div>
                        <div class="setting-row">
                            <label for="maxY">Massimo Y (mm):</label>
                            <input type="number" id="maxY" value="100" step="10">
                        </div>
                        <div class="setting-row">
                            <label for="gridSize">Dimensione griglia secondaria (mm):</label>
                            <input type="number" id="gridSize" value="10" min="1" step="1">
                        </div>
                        <div class="setting-row">
                            <label for="snapSize">Snap alla griglia (mm):</label>
                            <input type="number" id="snapSize" value="1" min="0.1" step="0.1">
                        </div>
                        <div class="setting-row">
                            <label for="enableSnap">Abilita snap:</label>
                            <input type="checkbox" id="enableSnap" checked>
                        </div>
                        <div class="setting-row">
                            <label for="pixelsPerMm">Pixel per mm (scala):</label>
                            <input type="number" id="pixelsPerMm" value="1" min="0.1" step="0.1">
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Etichette Assi</h3>
                        <div class="setting-row">
                            <label for="xAxisLabel">Etichetta asse orizzontale:</label>
                            <select id="xAxisLabel">
                                <option value="X">X</option>
                                <option value="Y">Y</option>
                                <option value="Z">Z</option>
                            </select>
                        </div>
                        <div class="setting-row">
                            <label for="yAxisLabel">Etichetta asse verticale:</label>
                            <select id="yAxisLabel">
                                <option value="X">X</option>
                                <option value="Y" selected>Y</option>
                                <option value="Z">Z</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Spline</h3>
                        <div class="setting-row">
                            <label for="samplingDistance">Distanza campionamento (mm):</label>
                            <input type="number" id="samplingDistance" value="2" min="0.1" step="0.1">
                        </div>
                        <div class="setting-row">
                            <label for="splineSmoothing">Fattore di smoothing:</label>
                            <input type="range" id="splineSmoothing" min="0" max="1" step="0.1" value="0.5">
                            <span id="smoothingValue">0.5</span>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Colori</h3>
                        <div class="setting-row">
                            <label for="splineColor">Colore spline:</label>
                            <input type="color" id="splineColor" value="#ff0000">
                        </div>
                        <div class="setting-row">
                            <label for="shapeColor">Colore forme:</label>
                            <input type="color" id="shapeColor" value="#0066cc">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="saveSettings" class="btn btn-primary">Salva</button>
                    <button id="resetSettings" class="btn btn-secondary">Reset</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>